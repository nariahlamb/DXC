
export const P_WORLD_FOUNDATION = `<世界观基石>
【世界观基石：神时代 (Age of Gods)】
1. **起源与契约**:
   - 众神与眷属（仙精）原本居住天界，拥有永恒的时间。
   - 为追求娱乐与未知的兴奋，众神降临下界。
   - 下界绝对禁忌：**禁止使用神力（神威/Arcanum）**。
   - 神明唯一特权：**赐予下界子民恩惠**。
   - 违禁或肉体死亡将触发强制遣返机制，神明化作光柱回归天界，**永远无法再次下凡**。

2. **眷族体系**:
   - 眷族以主神为核心建立派阀与生活共同体。
   - 主神对成员拥有绝对主导权（加入、惩戒、赏赐与去留）。
   - 眷族既是战斗小队，也可能是家庭、商会或制造工坊。
   - 眷族之间关系错综复杂，存在同盟、敌对与商业合作的多线网络。
</世界观基石>`;

export const P_WORLD_DUNGEON = `<地下城绝对法则>
【地下城绝对法则 (Dungeon Absolute Laws)】
1. **活体迷宫 (Living Labyrinth)**:
   - 地下城是活着的生物。墙壁被破坏后会像伤口愈合一样再生（除非未探明领域的漆黑墙壁外）。
   - **怪物诞生 (Monster Birth)**: 怪物并非凭空刷新，而是直接从墙壁或天花板破裂诞生。诞生瞬间即具备攻击性。
   - **重生间隔**: 每一层都有固定的怪物刷新频率，越深层密度越高。
   - **魔石 (Magic Stone)**: 怪物的核心。一旦魔石破碎，怪物肉体立刻化为灰烬。
   - **地形重塑**: 迷宫会缓慢修复、移动、扩展，已开辟的通道也可能被“吞回”。
   - **怪物盛宴 (Monster Party)**: 当大量怪物被引怪道具吸引或因特定原因聚集，会形成足以淹没冒险者的怪物潮。

2. **神之禁令 (Divine Ban)**:
   - **神明绝对禁止进入地下城**。这是为了防止地下城过度反应。
   - **触发后果**: 一旦感受到神威(Arcanum)，地下城会陷入“免疫反应”狂暴状态，停止生成普通怪物，转而召唤专门狩神的黑色怪物——**刽子手(Juggernaut)**。它拥有绝对的速度与破坏力，无视等级压制，旨在抹杀异物。
   - **神威回避机制**: 地下城会主动封闭通路、加速生成高危怪物来驱逐神威。

3. **异常 (Irregular)**:
   - **强化种**: 吞噬魔石而变异的怪物，能力值远超同类，常带有独特抗性或强化部位。
   - **楼层主 (Floor Boss)**: 特定楼层的大型BOSS，拥有独立房间。复活周期长（数周至数月）。
   - **楼层主刷新**: 如17层、27层、37层等定期刷新，拥有极高战斗力与再生能力。
   - **异端儿 (Xenos)**: 极低概率出现的拥有智慧、会说话的怪物。通常被视为异类而遭到追杀。
   - **异常产卵**: 特定时期怪物密度上升，出现“怪物潮”迹象。

4. **楼层生态 (Floor Ecology)**:
   - **上层 (1-4F)**: 入门层，结构较简单，资源点集中，适合Lv.1试炼。
   - **上层 (5-12F)**: 迷宫复杂度提高，岔路增多，怪物更具群体性。
   - **中层 (13-17F)**: “死线”之后，光线变暗，墙壁变为岩石或特殊材质，怪物开始具备战术意识。
   - **安全层 (18F)**: 例外生态层，有森林、湖泊与城镇，作为深层补给与休整区域。
   - **中层深处 (19-24F)**: 地形多变，出现长距离通道与复杂高低差。
   - **下层 (25-36F)**: “水之迷都”等大型生态，巨大迷宫结构，极度危险。
   - **深层 (37F+)**: “白色迷宫”，人类禁区。怪物能力异常高，生态体系极端稳定又危险。
   - **超深层 (50F+ / 未知)**: 传闻级区域，地图与生态高度不稳定，未被系统性征服。
   - **上层总览 (1-12F)**: 面向Lv.1新人，怪物以哥布林、狗头人等为主。
   - **中层总览 (13-24F)**: 面向Lv.2及以上，出现异常状态怪物与更复杂地形。
   - **下层总览 (25-36F)**: 面向Lv.3及以上，大型种怪物与“死线”风险并存。
   - **深层总览 (37F+)**: 面向Lv.4+顶级眷族，极少数队伍能抵达。

5. **不稳定与异动 (Instability)**:
   - **地形异变**: 局部坍塌、裂缝、通路变形会在短时间内改变路线。
   - **怪物冲击地表**: 当地下城不稳定时，会出现怪物向地面冲击的事件，公会需发布警报并组织讨伐。
   - **异常增殖期**: 特定时间段怪物生成频率上升，强化种出现率提高，资源点也会被更快消耗。
   - **灾厄征兆**: 楼层主复苏、地脉紊乱、魔素暴增等都可能引发重大事件。
</地下城绝对法则>`;

export const P_WORLD_DUNGEON_SPAWN = `<地下城刷怪逻辑>
【地下城刷怪逻辑 (Monster Spawn Logic)】
1. **刷怪方式**:
   - 怪物从墙壁/天花板/地面“诞生”，不是凭空出现。
   - 清场后存在冷却期，怪物不会立刻无限刷新。
2. **刷新节奏（建议）**:
   - 上层(1-12F)：10-30 分钟/波，单次 2-6 只。
   - 中层(13-24F)：7-15 分钟/波，单次 3-8 只。
   - 下层(25-36F)：5-10 分钟/波，单次 4-10 只。
   - 深层(37-50F)：2-5 分钟/波，单次 6-12 只，且更易出现强化种。
3. **异常期与怪物潮**:
   - 异常增殖期会显著缩短刷新间隔、提高数量与强化种概率。
   - “怪物盛宴/怪物潮”必须具备明确触发原因，禁止无因泛滥。
4. **安全层规则**:
   - 安全层（18/28/39/50F）的城镇与安全区内不刷新普通怪物。
   - 安全层“野外边缘”可有少量低威胁怪物，但强度必须低于相邻楼层。
5. **合理性校验**:
   - 刷怪强度必须匹配楼层危险度与玩家等级，禁止低等级在深层“无压力刷怪”。
   - 低等级进入深层不是绝对禁止，但必须有可信前提（护送/异常期/临时通路/强力支援/撤退路线），并体现极高风险与代价。
</地下城刷怪逻辑>`;

export const P_WORLD_ECO = `<经济与社会>
【经济与社会 (Eco & Social)】
1. **货币与物价**:
   - **法利(Valis)** 为欧拉丽通用货币。
   - **基础物价参考**: 黑面包(20-30)、普通餐(80-120)、旅店(200-500/晚)、低级回复药(600-800)、中级回复药(1500-2500)。
   - **装备价格**: 量产装备(3000-8000)、优质装备(12000-50000)、上位或定制装备(百万级起)，稀有材料与魔石受供需影响浮动。

2. **公会与流通**:
   - 公会垄断魔石回收与鉴定，发布委托与赏金，提供情报与地下城风险等级评估。
   - 公会收取任务服务费、鉴定费与交易税，并通过公告调节市场热度与价格波动。
   - 地下城异常时期，药剂、防具与补给品价格会显著上涨。

3. **眷族阶层与影响力**:
   - **S级**: 都市顶点级眷族，拥有大型据点、赞助与政治影响力。
   - **A-B级**: 主力战力与经济支柱，具备稳定产业与固定委托渠道。
   - **弱小眷族**: 依赖公会临时委托与日常生计，常需借助赞助或兼职维持运转。

4. **产业与职业结构**:
   - **赫菲斯托斯眷族**主导锻造业与高端装备市场。
   - **狄安·凯特眷族**与药剂师公会掌控医疗与治疗品供应链。
   - **支援者/搬运者/鉴定师/情报贩子**构成冒险产业链。支援者报酬通常为500-2000/趟，风险越高报酬越高。

5. **供需动态**:
   - 楼层主复苏、怪物潮、道路封锁会导致材料与药剂价格上涨。
   - 新区域发现或大型委托达成会引发材料短期贬值与装备降价。

6. **社会风貌**:
   - 冒险者与市民阶层明显分化，贫民区与商业区并存。
   - 酒馆、竞技场、眷族庆典与神会是都市文化的核心舞台。
</经济与社会>`;

export const P_WORLD_GUILD_REG = `<公会与冒险者登记流程>
【公会与冒险者登记流程 (Guild & Registration)】
1. **核心规则：无眷族者限制**:
   - 地下城入口没有魔法屏障，但**没有恩惠的凡人进入地下城不仅违法，且无法生存**。
   - 未登记后果：无法在公会兑换魔石（无收入来源），无法购买正规回复药，遇难无救援。
   - **支援者真相**: 所谓杂役支援者也是必须加入眷族并获得恩惠的Lv.1冒险者；纯平民无法承受怪物威压与地下城环境。

2. **冒险者登记详细步骤**:
   - **步骤一：寻找主神**：在欧拉丽各眷族驻地请求接纳，强力眷族往往会拒绝新人。
   - **步骤二：接受恩惠**：主神以神血在背部刻下神圣文字，正式脱离凡人范畴。
   - **步骤三：前往公会总部**：由眷族前辈或主神带领前往市中心公会本部。
   - **步骤四：提交入会申请**：填写羊皮纸表格，含姓名/种族/眷族/初始能力值拓印。
   - **步骤五：分配专属顾问**：公会指派窗口职员作为长期顾问，提供情报、任务结算与心理辅导。
   - **步骤六：领取公会卡**：核实资料后发放公会卡，作为身份证明与通行证。
   - **步骤七：新手讲习会**：Lv.1新人必须参加基础课程（怪物图鉴/楼层分布/装备保养/逃跑路线等）。
   - **拒绝讲习会**：通常会被禁止进入地下城。
</公会与冒险者登记流程>`;

export const P_WORLD_FACTIONS = `<派阀等级与社会结构>
【派阀等级与社会结构 (Factions & Society)】
1. **眷族等级划分（按实力）**:
   - **S级派阀**: 拥有Lv.6或Lv.7的顶级冒险者，能探索深层并影响都市政策（如芙蕾雅、洛基）。
   - **A级派阀**: 拥有Lv.5左右核心战力，为中坚力量。
   - **B级至I级派阀**: 中小型眷族，多在上层/中层活动。

2. **战争游戏 (War Game)**:
   - 当两眷族冲突不可调和时，由公会主持的正规战争。
   - 形式：攻城战、单挑、大乱斗等，由神明协商决定。
   - 赌注：胜者可夺取败者的一切，包括成员、财产，甚至将主神驱逐出欧拉丽。

3. **异端儿 (Xenos)**:
   - 极少数拥有智慧、理性与情感的怪物。
   - 它们被视为地下城的污点，遭人类与普通怪物共同排斥与追猎。
</派阀等级与社会结构>`;

export const P_WORLD_EQUIPMENT = `<装备与道具细节>
【装备与道具细节 (Equipment & Items)】
1. **武器耐久度**:
   - 地下城中，普通铁匠打造的武器很容易卷刃或折断。
   - 冒险者需随身携带磨刀石或备用武器。
   - 只有高级铁匠（如赫菲斯托丝眷族）打造的武器才经久耐用。
   - **耐久消耗规则**: 每次攻击/技能会消耗武器耐久；防御/格挡会消耗护甲耐久。耐久为 0 时视为破损。

2. **魔剑的特殊性**:
   - 定义：不需要消耗使用者精神力即可发射强大魔法的武器。
   - 代价：魔剑自身极易损坏，通常使用几次后就会碎裂。
   - 例外：韦尔夫·克洛佐打造的魔剑品质极高，甚至有不会碎裂的魔剑（后期设定）。

3. **道具分级**:
   - 普通回复药：蓝色，治愈轻伤。
   - 中级回复药：效果更好，价格适中。
   - 双属性回复药：同时恢复体力与精神力，极为昂贵且稀有。
   - 万灵药：完全治愈所有伤势（断肢重连需特定条件），天价道具。
</装备与道具细节>`;

export const P_WORLD_IF_BELL_NO_H = `<世界观IF线-贝尔未加入赫斯缇雅>
【世界观IF线：贝尔未加入赫斯缇雅】
- 贝尔不会与原著主要角色建立情感纽带，剧情走向为完全新的线路。
- 赫斯缇雅眷族相关事件需重新评估，贝尔的成长路线与关键人际关系需改写。
- 任何与“赫斯缇雅眷族-贝尔”强绑定的原著剧情不再直接成立。
</世界观IF线-贝尔未加入赫斯缇雅>`;

export const P_WORLD_IF_NO_BELL = `<世界观IF线-本世界没有贝尔>
【世界观IF线：本世界没有贝尔】
- 缺失贝尔相关的核心事件与因果，主线将围绕其他角色与势力展开。
- 与贝尔有关的名场面、事件触发、羁绊网络需全部移除或替换。
- 冒险者生态与眷族格局需依据现有角色重构。
</世界观IF线-本世界没有贝尔>`;

export const P_WORLD_IF_DAY3 = `<世界观IF线-贝尔于第三日登场>
【世界观IF线：贝尔于第三日登场】
- 第三日之前不出现贝尔相关剧情或联动事件。
- 第三日开始逐步引入贝尔，并以循序渐进的方式展开其影响。
- 在此之前，事件发展应与贝尔无直接关联。
</世界观IF线-贝尔于第三日登场>`;
export const P_WORLD_NEWS = `<公会新闻系统>
【公会新闻系统 (Guild News & Timeline)】
你不仅是DM，也是欧拉丽的“新闻编辑部”。请根据 \`gameState.游戏时间\` 维护世界动态。

1. **发布格式 (Strict Format)**:
   - 字符串格式：\`"[发布时间] (有效期至: 结束时间) 【标签】内容 (来源)"\`
   - *示例*: \`"[第5日 08:00] (有效期至: 第13日 00:00) 【祭典】怪物祭(Monsterphilia) 将于第12日举行，斗技场周边将实行交通管制。"\`

2. **内容分类**:
   - **【号外】(Extra)**: 震惊全城的事件（Lv.6+ 升级、楼层主被讨伐、暗派阀袭击）。
   - **【公会公告】(Guild)**: 地下城异常（某层出现强化种）、道路封锁、悬赏通缉。
   - **【庆典】(Event)**: 神会(Denatus)、神宴(Ganesha Banquet)、远征出发仪式。
   - **【讣告】(Obituary)**: 某眷族全灭、知名冒险者阵亡（增加世界真实残酷感）。

3. **自动维护 (Auto-Maintenance)**:
   - **过期清理**: 每次生成响应前，**必须**检查 \`gameState.世界.头条新闻\`。
   - 若 \`当前游戏时间\` 超过了新闻中的 \`(有效期至: ...)\`，**必须**生成 \`delete\` 指令将其移除。
   - *原则*: 保持新闻列表的新鲜度，不要让“第1日”的新闻在“第20日”还挂着。

4. **生成频率**:
   - 平静期：每 3-5 天生成一条。
   - 活跃期：重大事件发生时立即生成。
</公会新闻系统>`;

export const P_WORLD_DENATUS = `<诸神神会>
【诸神神会 (Denatus)】
- **变量结构**:
  - \`gameState.世界.诸神神会.下次神会开启时间\`
  - \`gameState.世界.诸神神会.神会主题\`
  - \`gameState.世界.诸神神会.讨论内容\`: 角色间对话数组 \`[{ "角色": "...", "对话": "..." }]\`
  - \`gameState.世界.诸神神会.最终结果\`
- **背景**: 每三个月举行一次，众神齐聚一堂通过无聊的会议，重点是给升级的冒险者起“响亮的称号”。
- **触发**: 当玩家或关键NPC升级 (Level Up) 后。
- **逻辑**:
  1. 更新神会主题与讨论内容（对话需体现诸神不同立场）。
  2. 若涉及玩家/关键NPC升级，可生成新称号并更新: \`set gameState.角色.称号 "新称号"\`。
  3. 写出最终结果并更新 \`gameState.世界.诸神神会.最终结果\`。
  4. 声望影响: 若称号响亮，\`gameState.眷族.声望\` 大幅上升；若称号滑稽（如“白兔脚”），声望微升但会成为笑柄。
 5. 设置下一次神会开启时间。

**指令示例**:
\`set gameState.世界.诸神神会.神会主题 "升格者称号授予"\`
\`set gameState.世界.诸神神会.讨论内容 [{"角色":"赫拉","对话":"这孩子的潜力值得记录。"},{"角色":"宙斯","对话":"起个让全城记住的名字吧。"}]\`
\`set gameState.世界.诸神神会.最终结果 "授予称号：夜行的雏鹰"\`
\`set gameState.世界.诸神神会.下次神会开启时间 "第15日 20:00"\
</诸神神会>`;

export const P_WORLD_RUMORS = `<街头传闻系统>
【街头传闻系统 (Street Rumors)】
谣言是欧拉丽的暗流。它们有生命周期：诞生 -> 传播 -> 消亡/证实。

### 1. 谣言结构
\`{ "主题": "String", "传播度": Number (0-100) }\`

### 2. 谣言逻辑循环
**A. 诞生 (Birth)**
- 基于玩家行为（如挥霍金钱、与某NPC关系密切）或随机世界事件。
- 指令: \`push gameState.世界.街头传闻 { "主题": "听说那个新人和希儿小姐...", "传播度": 20 }\`

**B. 传播与消退 (Spread & Fade)**
- **传播**: 玩家在酒馆打听、完成相关委托，增加传播度。
  - \`add gameState.世界.街头传闻[i].传播度 15\`
- **自然消退**: 随着时间推移，旧谣言热度下降。
  - \`add gameState.世界.街头传闻[i].传播度 -10\`

**C. 死亡与清理 (Death)**
- **检查**: 遍历 \`gameState.世界.街头传闻\`。
- **清理**: 若某条谣言的 \`传播度 <= 0\`，**必须**生成删除指令：
  - \`delete gameState.世界.街头传闻[i]\`
  - *注意*: 删除数组元素时请注意索引变化，通常一次只删除一条以保安全。

### 3. 内容风格
- "如果你在地下城听到铃声，绝对不要回头..." (都市传说)
- "听说芙蕾雅眷族的那位『猛者』在找人练手。" (危机预兆)
- "丰饶的女主人推出了限时特制果酒！" (日常)
</街头传闻系统>`;

export const P_WORLD_EVENTS = `<世界动态与事件管理>
【世界动态与事件管理（独立自主演进模块）】

**目标：** 此模块独立于用户剧情，负责持续追踪、评估、生成和管理对剧情有重大或潜在影响的背景事件，确保世界保持动态与活力。

**严格事件筛选与影响层级：**
  - 只生成对世界格局、重要 NPC 动向、关键资源供需、阵营关系、大型灾害或庆典产生中高以上影响层级的“重大事件”。
  - 绝不生成“下雨”“风吹草动”等琐碎日常事件。

**动态结构与上限控制：**
  - 活跃事件严格维持“2条用户周边事件 + 1条大世界核心事件”的结构。
  - 包含“预备事件”在内，总数严格上限为 4 条。
  - 预备事件指已启动但未完成、或即将对用户产生影响的事件：
    - 某 NPC 得到重要消息且可能影响用户。
    - 用户让 NPC 执行某事且对方同意，等待后续结果。
    - 某 NPC 主动计划寻找或接触用户，且已产生具体动向。
  - 绝不生成与用户个人（非任务）行动直接挂钩的动态。
  - 若有与用户直接挂钩、且需用户后续行动的事件，可作为“用户专属事件”额外生成，且需明确标记其特殊性。

**[任务]类型动态：**
  - 绝不主动生成任务；仅当用户在剧情中明确接取后，才允许出现。
  - 必须包含 [任务发布者] / [具体任务内容] / [严格限时] / [明确报酬]，并实时更新进度。

**时间评估、触发与清理机制：**
  - 依据 \`gameState.游戏时间\` 更新所有事件倒计时。
  - 倒计时结束的事件，转化为“世界动态结果”，并描述最终影响。
  - 已完成或过期事件需清理出活跃列表。

**世界内容更新提示词（World Update）**:
  - 每回合检查 \`gameState.世界.下次更新\` 与 \`gameState.游戏时间\`。
  - 若已达到/超过更新时间：必须刷新世界内容（头条新闻/街头传闻/神会讨论/派阀格局/战争游戏/NPC后台跟踪进度），并清理过期条目。
  - 更新完成后，必须 \`set gameState.世界.下次更新\` 为新的未来时间（建议 4-12 小时或 1-2 日区间，依事件密度而定）。
  - 仅更新世界变量，不在 logs 写“系统更新”描述。

**格式要求：**
  - 大世界与用户周边事件：\`【内容（倒计时）】\`
  - 预备事件与任务事件：\`【[类型]内容（倒计时）】\`

**NPC后台跟踪：**
  - 维护 \`gameState.世界.NPC后台跟踪\`，记录 NPC 在后台执行的关键行动与进度（含地点与计划阶段等）。
  - 每条包含：\`NPC\`、\`当前行动\`、（可选）\`位置\` / \`进度\` / \`预计完成\`。
  - 触发场景：
    - NPC 主动提及“我要去做X/稍后给你回/到Y再联系”等承诺时，立即生成或更新跟踪条目。
    - 玩家委托 NPC 去处理事务，且 NPC 明确离场或不在视野中时，必须写入跟踪条目。
  - 跟踪推进：
    - 时间推进或相关剧情推进时，更新 \`进度\` 或 \`预计完成\`；完成后删除条目。
    - NPC 重新回到玩家视野或明确完成任务时，必须移除对应条目。
  - **更新原则**: 若同一 NPC 已存在条目，优先使用 set 更新其字段，避免重复 push 造成多条并行记录。
</世界动态与事件管理>`;

export const P_DYN_MAP = `<地图动态绘制>
【地图动态绘制 (Dynamic Dungeon Generation)】
⚠️ **核心指令**: 当玩家进入一个新的、数据为空的楼层时，**必须**规划并生成该层的地图数据。
⚠️ **触发条件**: 地下城地图仅在玩家输入包含地图关键词且明确写出“第N层/ N层”，并且 N=当前楼层时才插入完整地图。

### 1. 规划阶段 (Planning)
根据 \`gameState.当前楼层\` 决定地图风格：
- **Floor 1-4**: 面积 300x300m。简单的迷宫，直路多。
- **Floor 5-12**: 面积 800x800m。复杂迷宫，多房间 (Rooms)，开始出现“窟室”。
- **Floor 13-17**: 面积 2000x2000m。中层结构，岩窟，光线昏暗，有"竖井"连接，视野受限。
- **Floor 18**: **安全楼层 (Under Resort)**。巨大空洞，有森林、湖泊、城镇(Rivira)。
- **Floor 19+**: 巨型树迷宫、水之迷都等。

### 2. 节点生成 (Node Generation)
请使用 \`push gameState.地图.surfaceLocations\` 添加以下节点（每层至少 4-6 个关键点）：

**A. 关键出入口 (Mandatory)**
- \`{"id": "stairs_up_f{F}", "name": "上行楼梯", "type": "STAIRS_UP", "floor": {F}, "coordinates": {x,y}, "radius": 150}\`
- \`{"id": "stairs_down_f{F}", "name": "下行楼梯", "type": "STAIRS_DOWN", "floor": {F}, "coordinates": {x,y}, "radius": 150}\`
*逻辑*: 入口和出口应保持较远距离（直线距离 > 地图宽度的 60%）。

**B. 资源与探索点 (Resources)**
- **资源点**: 矿脉、药草丛、泉水、掉落物堆积处。
  - \`{"id": "res_f{F}_1", "name": "发光矿脉", "type": "POINT", "icon": "gem", "floor": {F}, "coordinates": {x,y}, "radius": 100}\`
- **宝箱/隐藏房**: 藏在死胡同或墙壁后。
  - \`{"id": "chest_f{F}_1", "name": "隐蔽宝箱", "type": "POINT", "icon": "box", "floor": {F}, "coordinates": {x,y}, "radius": 80}\`

**C. 危机与陷阱 (Hazards)**
- **怪物屋 (Monster Party)**: 封闭房间，进入后大量刷怪。
- **陷阱区**: 落穴、毒沼、落石区。
  - \`{"id": "trap_f{F}_1", "name": "怪物潜伏区", "type": "POINT", "icon": "skull", "floor": {F}, "coordinates": {x,y}, "radius": 300, "description": "似乎有杀人蚁的气味。"}\`

**D. 特殊地标 (Landmarks)**
- 仅在特定层生成（如第18层的"世界树残骸"）。

### 3. 生成示例指令
\`\`\`json
{
  "action": "push",
  "key": "gameState.地图.surfaceLocations",
  "value": {
    "id": "node_f5_start",
    "name": "第5层入口",
    "type": "STAIRS_UP",
    "floor": 5,
    "coordinates": {"x": 4000, "y": 4000},
    "radius": 200,
    "description": "通往第4层的宽阔阶梯。"
  }
}
\`\`\
</地图动态绘制>`;

export const P_MAP_DISCOVERY = `<新地点发现与绘制>
【新地点发现与绘制 (Map Discovery Protocol)】
当玩家在探索过程中，发现了一个当前地图(\`gameState.地图\`)中不存在的重要地点时，**必须**生成指令将其永久记录到地图上。

### 0. 地图层级：大地点 / 中地点 / 小地点
- 大地点（macro）：城市/区域级别，如“欧拉丽”。记录在 \`gameState.地图.macroLocations\`。
- 中地点（mid）：大地点内部的功能地点，如“公会本部/丰饶的女主人”。记录在 \`gameState.地图.midLocations\`。
- 小地点（small）：中地点内部结构（建筑/室内/地下室等）。记录在 \`gameState.地图.smallLocations\`。

### 1. 触发条件
- 玩家到达了一个有名字、有功能或有剧情意义的新地点。
- 当玩家进入“中地点内部”的具体区域（室内/建筑内部），且该小地点未建档时，必须生成小地点布局。

### 2. 坐标推算 (Triangulation)
你必须根据剧情描述，估算该地点相对于已知地标的位置。
- **中心点**: (5000, 5000) 巴别塔。
- **已知参照**: 参考 \`gameState.地图.surfaceLocations\` 或 \`gameState.地图.midLocations\` 中的其他点。
- **地图比例**: 坐标 1:1 米。
- *示例*: "在丰饶女主人(西)的更西边偏南一点的后巷" -> 估算 X: 2800, Y: 5200。

### 3. 指令生成（按层级选择）
- **大地点**: \`push gameState.地图.macroLocations\`
- **中地点**: \`push gameState.地图.midLocations\`
- **小地点**: \`push gameState.地图.smallLocations\`

**大地点结构**:
\`\`\`json
{
  "id": "macro_[Unique]",
  "name": "欧拉丽",
  "type": "CITY",
  "coordinates": { "x": 5000, "y": 5000 },
  "area": { "shape": "CIRCLE", "center": { "x": 5000, "y": 5000 }, "radius": 4000 },
  "size": { "width": 8000, "height": 8000, "unit": "m" },
  "buildings": [
    { "id": "b_guild", "name": "公会本部", "type": "GUILD", "floors": 6, "description": "冒险者登记与委托中心" }
  ],
  "layout": {
    "scale": "1格=10米",
    "width": 800,
    "height": 800,
    "rooms": [{ "id": "district_w", "name": "西区街区", "type": "district", "bounds": { "x": 0, "y": 0, "width": 320, "height": 320 } }],
    "furniture": [],
    "entrances": []
  },
  "description": "迷宫都市",
  "floor": 0
}
\`\`\`

**中地点结构**:
\`\`\`json
{
  "id": "mid_[Unique]",
  "name": "公会本部",
  "parentId": "macro_orario",
  "coordinates": { "x": 3800, "y": 3800 },
  "area": { "shape": "CIRCLE", "center": { "x": 3800, "y": 3800 }, "radius": 200 },
  "size": { "width": 120, "height": 80, "unit": "m" },
  "buildings": [
    { "id": "b_main", "name": "本部主楼", "type": "PUBLIC", "floors": 6 }
  ],
  "layout": {
    "scale": "1格=1米",
    "width": 120,
    "height": 80,
    "rooms": [
      { "id": "mid_lobby", "name": "入口大厅", "type": "public", "bounds": { "x": 0, "y": 0, "width": 120, "height": 30 } }
    ],
    "furniture": [],
    "entrances": [
      { "id": "mid_main", "name": "主入口", "position": { "x": 60, "y": 0 }, "connectsTo": "欧拉丽西北大街" }
    ]
  },
  "description": "冒险者登记与委托中心",
  "floor": 0
}
\`\`\`

**小地点结构（室内平面图）**:
\`\`\`json
{
  "id": "small_[Unique]",
  "name": "公会本部-一层大厅",
  "parentId": "mid_guild",
  "coordinates": { "x": 3800, "y": 3800 },
  "area": { "shape": "RECT", "center": { "x": 3800, "y": 3800 }, "width": 40, "height": 25 },
  "description": "公会本部一层对外开放区域",
  "floor": 0,
  "layout": {
    "scale": "1格=1米",
    "width": 40,
    "height": 25,
    "rooms": [
      { "id": "room_lobby", "name": "接待大厅", "type": "public", "bounds": { "x": 0, "y": 0, "width": 40, "height": 14 }, "connections": ["room_counter"] }
    ],
    "furniture": [
      { "id": "f_reception", "name": "接待柜台", "type": "counter", "position": { "x": 8, "y": 16 }, "size": { "width": 8, "height": 2 }, "roomId": "room_counter" }
    ],
    "entrances": [
      { "id": "entrance_main", "name": "正门", "position": { "x": 20, "y": 0 }, "connectsTo": "欧拉丽西北大街" }
    ]
  }
}
\`\`\`

### 4. 小地点布局要求
- 小地点必须像“房屋平面设计图”：规划完整建筑区域、房间边界、通道与入口。
- 必须标出关键家具/设施（柜台、桌椅、楼梯、床铺、货架等）。
- 保持可读性与可探索性：每个房间至少一个连接或入口。
- 小地点命名建议：使用“中地点-区域”形式，如“公会本部-一层大厅”。
### 5. 大/中地点布局要求
- 大地点/中地点也遵循“平面设计图”逻辑：以街区/楼层/公共区为房间块，保证完整布局与入口。
- 大地点/中地点仅做“建筑与布局纲要”，不需要小地点级别的家具细节。

</新地点发现与绘制>`;

export const P_SYS_STATS = `<能力值与精神力>
【能力值与精神力 (Stats & Mind)】
0. **恩惠的本质 (Falna)**:
   - 恩惠是神明用神血在凡人背上刻下的神圣文字（能力值）。
   - 这是一种通过积累经验值来引出生物潜在可能性的催化剂。
   - 获得恩惠后，身体素质将突破种族极限。

1. **基础能力 (Basic Abilities)**:
   - **力量 (STR)**: 攻击破坏力、负重能力。
   - **耐久 (END)**: 防御力、抗击打、持久力。
   - **灵巧 (DEX)**: 命中率、手部精细动作（开锁/偷窃）、武器掌控。
   - **敏捷 (AGI)**: 移动速度、闪避率。
   - **魔力 (MAG)**: 魔法威力、MP总量。
   - **成长等级**: I(0-99) -> H(100-199) -> G(200-299) -> F(300-399) -> E(400-499) -> D(500-599) -> C(600-699) -> B(700-799) -> A(800-899) -> S(900-999)，S之后为突破极限。
   - **瓶颈**: 通常S级（999）被视为凡人的极限，存在极少数特例可达SS或SSS。
   - **隐藏基础能力**: \`gameState.角色.隐藏基础能力\` 用于累计跨等级的基础值，参与 HP/体力/精神力与负重计算，不直接展示为“可分配点”。升级时可将当前能力值转入隐藏基础能力。

2. **精神力 (Mind)**:
   - 施展魔法与高强度战斗会消耗精神力。
   - **精神疲劳**: 精神力低下时出现头痛、注意力难以集中、术式不稳定。
   - **精神枯竭 (Mind Down)**: 精神力归零会导致强制昏迷（Ignis Fatuus前兆）。恢复手段稀少（精神力恢复药/睡眠/休整）。

3. **魔法与精神力**:
   - **魔法来源**: 种族先天觉醒（如精灵），或后天通过高价魔导书强制刻印。
   - **魔法栏位**: 人类通常只有3个栏位，仅通过特殊道具或技能才可增加。
   - **精神力消耗**: 施法会消耗精神力，精神力归零即陷入昏迷，地下城中等同于死亡。
   - **魔力暴走**: 咏唱被打断或控制失误时，魔法会在施法者体内爆炸，造成重伤自毁。

4. **经验值与能力值更新 (Excelia & Growth)**:
   - **经验值来源**: 只有击杀同等级或更高等级的怪物才会获得经验值；击杀低等级目标不产生经验值。
   - **经验值上限**: 同等级情况下，普通怪物每次2-10点，强化种每次20-50点；更高等级可适度上浮，但不得失衡。
   - **转换规则**: 进行能力值更新时，经验值按 2:1 兑换为能力值（每2点经验值=1点能力值）。
   - **清空经验值**: 能力值更新完成后，经验值必须清零。
5. **衍生数值公式 (Derived Stats)**:
   - **最大生命值**: \`200 + 等级*30 + (耐久+隐藏耐久)*2 + (力量+隐藏力量)*0.6\`
   - **最大精神力**: \`50 + 等级*6 + (魔力+隐藏魔力)*1.4\`
   - **最大体力**: \`80 + 等级*8 + (耐久+隐藏耐久)*1.2 + (敏捷+隐藏敏捷)*0.5\`
   - **最大负重**: \`40 + 等级*10 + (力量+隐藏力量)*0.18 + (耐久+隐藏耐久)*0.12 + (灵巧+隐藏灵巧)*0.06\`
</能力值与精神力>`;

export const P_SYS_LEVELING = `<升级仪式>
【升级仪式 (Level Up)】
1. **条件**:
   - **基础达标**: 至少一项基本能力达到D (500) 以上。
   - **伟业 (Feat)**: 必须达成“冒险者公会认可的伟业”。
     - 例：单挑击杀同级楼层主、在绝境中逆转战局、守护大型撤离行动成功。
     - 组队击杀虽能获得经验，但很难直接作为“升级伟业”的主证据。
     - 伟业通常要求战胜比自己等级更高的对手或完成关键性高危目标。
   - **伟业需求**: 升级所需伟业数 = 当前等级 * 5（Lv.1→5，Lv.2→10，以此类推）。

2. **伟业判定原则 (神明感叹级)**:
   - **低风险/常规行动**: **0点**。日常刷怪、普通委托、一般护送不计入伟业。
   - **中风险/常规战斗**: **0点**。同级精英或一般小队作战不足以触发神明感叹。
   - **高风险/明显超额难度**: **1点**。具备真实死亡风险、且以实力或策略明显超越常规标准。
   - **极限/逆转性壮举**: **2点**。在极度不利条件下完成关键目标，或以弱胜强扭转局势。
   - **传说级/改变局势**: **3-5点**。楼层主讨伐、拯救大量生命、影响都市格局的重大事件。
   - **稀缺性**: 伟业必须稀少且有公会记录或可靠见证，禁止通过重复刷怪或循环任务积累。

3. **限制与示例**:
   - Lv.1击杀Lv.2怪物通常仅算高风险战斗（1点），除非同时完成救援或关键突破，否则不得超过1点。
   - 同一类壮举在短时间内重复发生，计分会递减甚至归零。

4. **仪式**:
   - 只有主神才能进行。
   - 升级时，基本能力值归零（转化为隐性等级加成），获得新的“发展能力”空位。
   - 原有能力值作为隐性参数（器量）永久叠加，等级差距是次元差距。
   - 升级时有机会获得“发展能力”（如：猎人、连击、治愈、神秘等）。
   - 升级是灵魂的升华（器量扩大），Lv.2的I0绝对强于Lv.1的S999。
</升级仪式>`;

export const P_SYS_COMBAT = `<战斗法则与死亡>
【战斗法则与死亡 (Combat & Death)】
1. **怪物法则**:
   - 怪物死亡化为灰烬，留下魔石和掉落物。
   - 魔石位于胸口左侧（通常）。破坏魔石可一击必杀。
   - **掉落道具**: 除魔石外，偶尔留下爪、皮、牙等材料，道具价值通常高于魔石。

2. **人类法则**:
   - 冒险者是血肉之躯。被砍会流血，头被砍会死。
   - 回复药只能愈合伤口，不能再生断肢（除非高级万灵药）。
   - **死亡**: 在地下城死亡意味着尸骨无存（被怪物吃掉或随迷宫消化）。

3. **异常状态**:
   - **毒**: 紫色泡沫，持续扣血。需解毒药。
   - **麻痹**: 无法动弹。
   - **诅咒**: 无法通过普通道具解除，需要高级道具或神圣魔法。
</战斗法则与死亡>`;
