{"id":"SOL-ISS-DSC-20260213-125122-006-s006","description":"为 SocialPhoneModal 增加核心流程组件测试，覆盖线程切换、发消息、论坛回复与板块筛选。","approach":"基于 SocialPhoneModal 现有中文文案构建 phoneState fixture，在不改生产逻辑前提下新增独立测试文件，直接验证关键回调与界面状态切换。","tasks":[{"id":"T1","title":"Create SocialPhoneModal test harness and fixtures","scope":"components/game/modals/SocialPhoneModal.test.tsx","action":"Create","description":"新增组件测试文件，提供 contacts、threads、forum boards/posts 的最小可运行 fixture。","modification_points":[{"file":"components/game/modals/SocialPhoneModal.test.tsx","target":"new test file","change":"新增 render helper、default props factory、phoneState fixture builders"}],"implementation":["创建 SocialPhoneModal.test.tsx 并引入 @testing-library/react 与 vitest。","封装 createPhoneState/createProps/renderModal，默认提供 private/group/public 线程与论坛帖子。","统一使用 vi.fn() 管理 onSendMessage/onReplyForumPost/onReadThread 等回调。"],"test":{"unit":["fixture 可渲染 COMM/CHAT/FORUM 视图","默认 props 在测试中可复用"],"commands":["npx vitest run components/game/modals/SocialPhoneModal.test.tsx --testTimeout=60000"],"coverage_target":0.7},"acceptance":{"criteria":["新增测试文件数量 = 1","fixture builder/helper 数量 >= 2","基础 smoke 用例数量 >= 1"],"verification":["执行命令: rg -n \"createPhoneState|createProps|renderModal\" components/game/modals/SocialPhoneModal.test.tsx，应至少命中 3 处","执行命令: npx vitest run components/game/modals/SocialPhoneModal.test.tsx --testTimeout=60000"]},"commit":{"type":"test","scope":"social-phone-modal","message_template":"test(social-phone-modal): add harness and fixtures","breaking":false},"depends_on":[],"estimated_minutes":25,"priority":1},{"id":"T2","title":"Add core flow component tests","scope":"components/game/modals/SocialPhoneModal.test.tsx","action":"Add","description":"补充线程切换、发送消息、论坛回复与筛选断言，覆盖 issue 指定关键路径。","modification_points":[{"file":"components/game/modals/SocialPhoneModal.test.tsx","target":"interaction test cases","change":"新增 CHAT/Forum 流程测试及回调参数断言"}],"implementation":["在 COMM 或 CHAT 视图中点击线程项，断言进入聊天详情并触发 onReadThread。","在活跃线程输入消息并点击“发送”，断言 onSendMessage 调用次数与参数。","在 FORUM 视图打开帖子详情并输入回复，点击“回复”后断言 onReplyForumPost 参数。","切换论坛板块并断言帖子列表仅显示目标板块内容，覆盖筛选路径。"],"test":{"unit":["线程切换会触发 onReadThread","发送消息触发 onSendMessage","论坛回复触发 onReplyForumPost","板块切换后帖子列表发生筛选"],"commands":["npx vitest run components/game/modals/SocialPhoneModal.test.tsx --testTimeout=60000"],"coverage_target":0.8},"acceptance":{"criteria":["核心流程用例数量 >= 4","核心回调断言数量 >= 3","筛选结果断言数量 >= 2"],"verification":["执行命令: npx vitest run components/game/modals/SocialPhoneModal.test.tsx --testTimeout=60000","执行命令: rg -n \"onSendMessage|onReadThread|onReplyForumPost|板块\" components/game/modals/SocialPhoneModal.test.tsx，应至少命中 4 处"]},"commit":{"type":"test","scope":"social-phone-modal","message_template":"test(social-phone-modal): cover core chat and forum flows","breaking":false},"depends_on":["T1"],"estimated_minutes":35,"priority":1}],"analysis":{"risk":"low","impact":"high","complexity":"medium"},"score":0.91,"is_bound":true,"created_at":"2026-02-13T13:24:04.077Z","bound_at":"2026-02-13T13:24:46.271Z"}
