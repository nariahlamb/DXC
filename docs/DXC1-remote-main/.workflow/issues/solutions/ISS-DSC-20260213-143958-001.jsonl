{"id":"SOL-ISS-DSC-20260213-143958-001-001","description":"将流式回调改为增量 chunk 协议（delta），并在 UI 端按增量拼接，避免反复全量拷贝。","approach":"围绕 performance/streaming-render 进行最小可回归改动，先补测试再修复实现，避免引入行为漂移。","tasks":[{"id":"T1","title":"Define failing test cases","scope":"utils/aiDispatch.ts","action":"Add","description":"先补最小失败用例，锁定问题的可复现实例。","modification_points":[{"file":"utils/aiDispatch.ts","target":"line 218","change":"流式阶段每次 emit 都传整段 fullText，UI 侧再整体 setState，文本越长成本越高，容易出现对话生成过程卡顿。"}],"implementation":["添加失败测试覆盖当前问题场景。","确认测试在修复前稳定失败。","记录输入输出与边界条件。"],"test":{"unit":["新增针对问题点的最小单测"],"integration":[],"commands":["npm test"],"coverage_target":0.75},"acceptance":{"criteria":["新增测试可稳定复现问题","修复后测试转为通过"],"verification":["测试结果可重复"]},"priority":1},{"id":"T2","title":"Implement fix with guardrails","scope":"utils/aiDispatch.ts","action":"Refactor","description":"将流式回调改为增量 chunk 协议（delta），并在 UI 端按增量拼接，避免反复全量拷贝。","modification_points":[{"file":"utils/aiDispatch.ts","target":"line 218","change":"将流式回调改为增量 chunk 协议（delta），并在 UI 端按增量拼接，避免反复全量拷贝。"}],"implementation":["实现最小修复并保持现有接口兼容。","加入必要保护逻辑（边界/异常/空输入）。","补充注释说明关键约束。"],"test":{"unit":["执行新增单测"],"integration":[],"commands":["npm test","npx tsc --noEmit"],"coverage_target":0.8},"acceptance":{"criteria":["问题场景不再复现","相关回归测试全部通过"],"verification":["单测通过","类型检查通过"]},"depends_on":["T1"],"priority":2}],"analysis":{"risk":"medium","impact":"high","complexity":"medium"},"score":0.76,"is_bound":true,"created_at":"2026-02-13T14:45:49.459Z","bound_at":"2026-02-13T14:45:49.459Z"}
