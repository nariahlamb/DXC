{"id":"SOL-ISS-DSC-20260213-125122-009-d7p8","description":"修复主菜单设置中保存按钮静默空操作问题，在 Home 场景显式禁用并提示不可用。","approach":"为 SettingsModal 增加保存能力开关与禁用态文案，在 Home 场景声明不支持存档保存，避免用户点击后无反馈。","tasks":[{"id":"T1","title":"Add save capability flag to SettingsModal","scope":"components/game/modals/SettingsModal.tsx","action":"Add","description":"扩展 SettingsModal props，引入 canSaveGame 并控制保存按钮状态。","modification_points":[{"file":"components/game/modals/SettingsModal.tsx","target":"SettingsModalProps and save button render","change":"新增 canSaveGame?: boolean，false 时禁用保存按钮并显示提示"}],"implementation":["在 props 定义中新增 canSaveGame，可选且默认 true","保存按钮根据 canSaveGame 渲染 disabled/提示文本","避免 canSaveGame=false 时触发 onSaveGame"],"test":{"unit":["canSaveGame=false 时保存按钮不可触发"],"integration":["游戏内场景（默认 true）仍可正常保存"],"commands":["npx tsc --noEmit"],"coverage_target":0.72},"acceptance":{"criteria":["Home 场景下保存按钮 disabled=true","disabled 状态点击后 onSaveGame 调用次数=0"],"verification":["执行命令: npx vitest run tests/ui/homeSettingsSaveAction.test.tsx","执行命令: rg -n \"canSaveGame\" components/game/modals/SettingsModal.tsx"],"manual_checks":["Home 打开设置后可看到保存不可用提示"]},"commit":{"type":"fix","scope":"settings-modal","message_template":"fix(settings): disable save action when save capability is unavailable","breaking":false},"depends_on":[],"estimated_minutes":25,"priority":1},{"id":"T2","title":"Configure Home to disable save action","scope":"components/Home.tsx","action":"Configure","description":"在 Home 场景传入 canSaveGame=false，明确声明该场景不执行存档保存。","modification_points":[{"file":"components/Home.tsx","target":"SettingsModal props around onSaveGame","change":"新增 canSaveGame={false} 并移除静默空操作歧义"}],"implementation":["保留 Home 的读取流程，不新增无状态保存逻辑","将 onSaveGame noop 与 canSaveGame=false 语义绑定，确保 UI 不误导","必要时增加说明注释，区分 Home 场景与游戏内场景"],"test":{"unit":["Home 传入 canSaveGame=false"],"integration":["Home 设置弹窗保存按钮不可用"],"commands":["npx vitest run tests/ui/homeSettingsSaveAction.test.tsx"],"coverage_target":0.76},"acceptance":{"criteria":["Home 页面不存在\"可点击但无效果\"的保存按钮","保存不可用提示文本在 Home 场景可见率=100%"],"verification":["执行命令: npx vitest run tests/ui/homeSettingsSaveAction.test.tsx --reporter=basic","执行命令: npx tsc --noEmit"],"manual_checks":["切换到游戏内 SettingsModal 时保存按钮恢复可用"]},"commit":{"type":"fix","scope":"home-settings","message_template":"fix(home): mark save action unavailable in main-menu settings","breaking":false},"depends_on":["T1"],"estimated_minutes":20,"priority":1},{"id":"T3","title":"Add regression tests for save-button dead action","scope":"tests/ui","action":"Add","description":"新增主菜单设置保存按钮禁用/提示回归测试。","modification_points":[{"file":"tests/ui/homeSettingsSaveAction.test.tsx","target":"new test suite","change":"新增 disabled 断言、点击无调用断言、场景差异断言"}],"implementation":["构建 Home 场景测试夹具并渲染 SettingsModal","断言保存按钮在 Home 场景禁用且点击无副作用","补充游戏内场景下保存按钮可用的对照用例"],"test":{"unit":["保存按钮状态回归"],"integration":["Home 与 GameInterface 场景差异回归"],"commands":["npx vitest run tests/ui/homeSettingsSaveAction.test.tsx","npx tsc --noEmit"],"coverage_target":0.8},"acceptance":{"criteria":["新增测试至少 3 条（disabled/noop/ingame-available）","回归测试执行通过率=100%"],"verification":["执行命令: npx vitest run tests/ui/homeSettingsSaveAction.test.tsx","执行命令: npx tsc --noEmit"],"manual_checks":["主菜单设置与游戏内设置均完成冒烟验证"]},"commit":{"type":"test","scope":"home-settings","message_template":"test(home): cover save-button dead-action regression","breaking":false},"depends_on":["T2"],"estimated_minutes":30,"priority":2}],"analysis":{"risk":"low","impact":"medium","complexity":"low"},"score":0.9,"is_bound":true,"created_at":"2026-02-13T13:18:11.541Z","bound_at":"2026-02-13T13:23:17.140Z"}
