{"id":"ISS-DBP-001","title":"主对话请求缺少超时，可能导致处理中状态无限挂起","severity":"critical","confidence":0.95,"source_finding":"F-001","dimension":"dialog-main-flow","file":"utils/aiGenerate.ts","line":34,"category":"timeout-missing","recommendation":"为 story 请求默认注入 timeoutMs，并支持设置覆盖。"}
{"id":"ISS-DBP-002","title":"OpenAI 兼容流式读取缺少 idle watchdog，半开连接可长期阻塞","severity":"critical","confidence":0.91,"source_finding":"F-005","dimension":"ai-transport-streaming","file":"utils/aiDispatch.ts","line":305,"category":"stream-hang-risk","recommendation":"reader.read 循环增加 idle 超时并绑定 AbortController。"}
{"id":"ISS-DBP-003","title":"流式 thinking 提取对累计全文重复解析，存在 O(n^2) 卡顿风险","severity":"critical","confidence":0.93,"source_finding":"F-012","dimension":"ai-transport-streaming","file":"hooks/gameLogic/useGameLogicCore.ts","line":7410,"category":"quadratic-cpu-risk","recommendation":"改增量解析或仅在流结束后做完整 thinking 解析。"}
{"id":"ISS-DBP-004","title":"AM 召回请求无超时且串行执行，放大首包延迟","severity":"high","confidence":0.87,"source_finding":"F-002","dimension":"dialog-main-flow","file":"hooks/gameLogic/useGameLogicCore.ts","line":7318,"category":"latency-amplifier","recommendation":"为召回请求设置短超时并允许降级跳过。"}
{"id":"ISS-DBP-005","title":"首回合 IP 补全请求无超时，延迟主流程释放","severity":"high","confidence":0.88,"source_finding":"F-003","dimension":"dialog-main-flow","file":"hooks/gameLogic/useGameLogicCore.ts","line":7445,"category":"post-response-blocking","recommendation":"IP 补全后台化，或设置独立短超时。"}
{"id":"ISS-DBP-006","title":"论坛自动生成无超时，in-flight 锁可长时间占用","severity":"high","confidence":0.9,"source_finding":"F-008","dimension":"context-and-phone-performance","file":"hooks/gameLogic/useGameLogicCore.ts","line":8366,"category":"availability-risk","recommendation":"phone 生成链路统一传入 signal 与 timeoutMs。"}
{"id":"ISS-DBP-007","title":"phone 生成调用分散且大多不可取消，易形成悬挂请求","severity":"high","confidence":0.89,"source_finding":"F-016","dimension":"context-and-phone-performance","file":"hooks/gameLogic/useGameLogicCore.ts","line":7787,"category":"unbounded-requests","recommendation":"引入 phone request scope controller，统一取消策略。"}
{"id":"ISS-DBP-008","title":"Prompt 拼装无硬预算，易生成超大上下文并拖慢响应","severity":"high","confidence":0.85,"source_finding":"F-014","dimension":"context-and-phone-performance","file":"utils/aiPrompt.ts","line":280,"category":"prompt-bloat","recommendation":"增加 token/字符预算与模块裁剪。"}
{"id":"ISS-DBP-009","title":"上下文模块大量 pretty JSON 序列化，主线程负担高","severity":"high","confidence":0.9,"source_finding":"F-015","dimension":"context-and-phone-performance","file":"utils/aiContext.ts","line":168,"category":"serialization-overhead","recommendation":"按 detailLevel 裁剪字段并限制数组长度。"}
{"id":"ISS-DBP-010","title":"每轮双重全量状态快照序列化，触发预处理耗时峰值","severity":"medium","confidence":0.83,"source_finding":"F-007","dimension":"context-and-phone-performance","file":"hooks/gameLogic/useGameLogicCore.ts","line":7370,"category":"main-thread-blocking","recommendation":"改增量快照或仅保留必要子结构。"}
{"id":"ISS-DBP-011","title":"State 微服务并行路径未传 signal，慢请求难回收","severity":"medium","confidence":0.86,"source_finding":"F-006","dimension":"ai-transport-streaming","file":"hooks/gameLogic/useGameLogicCore.ts","line":5760,"category":"cancellation-gap","recommendation":"runStateParallelBySheet 透传 signal 并配套超时。"}
{"id":"ISS-DBP-012","title":"配置层缺少 story/phone/world 超时字段，无法运营调优","severity":"medium","confidence":0.88,"source_finding":"F-017","dimension":"dialog-main-flow","file":"types/ai.ts","line":14,"category":"operability-gap","recommendation":"在 GlobalAISettings/AppSettings 增加通用请求超时配置。"}
